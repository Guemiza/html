stages:
  - test
  - deploy

variables:
  PYTHON_IMAGE: "python:3.8"
  NODE_VERSION: "16"  # Remplacez par la version de Node.js souhaitée

test:
  stage: test
  image: $PYTHON_IMAGE
  script:
    - apt-get update -qy
    - pip install -r requirements.txt
    - python3 manage.py test

deploy:
  stage: deploy
  script:
    - apt-get update -qy
    - apt-get install -y nodejs npm
    - npm install -g n
    - n $NODE_VERSION
    - pip install -r requirements.txt
    - python3 manage.py migrate
    # Ajoutez d'autres commandes de déploiement si nécessaire

# Ajoutez cette section pour spécifier la version de l'action setup-python
setup_python:
  stage: test
  script:
    - name: Set up Python
      uses: actions/setup-python@v2.5.0  # Remplacez par la version souhaitée
      with:
        python-version: 3.8
